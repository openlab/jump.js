<!doctype html>
<html lang="en">
   <head>
		<title>Bing maps filtering - jump.js - jQuery Bing maps plugin</title>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta http-equiv="content-language" content="en" />
		<meta name="author" content="Johan Säll Larsson" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<meta name="description" content="A jQuery Bing maps filtering example using jQuery Bing maps v7 plugin jump.js for web and mobile" />
		<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
		<meta name="DC.title" content="Bing maps filtering - jump.js - jQuery Bing maps plugin" />
		<meta name="DC.description" content="A jQuery Bing maps filtering example using jQuery Bing maps v7 plugin jump.js for web and mobile" />
		<meta name="DC.creator" content="Johan Säll Larsson" />
        <meta name="DC.language" content="en" />
		<link type="text/css" rel="stylesheet" href="css/960/960.css" />
		<link type="text/css" rel="stylesheet" href="css/960/960_16_col.css" />
		<link type="text/css" rel="stylesheet" href="css/normalize/normalize.css" />
		<link type="text/css" rel="stylesheet" href="css/prettify/prettify.css" />
		<link type="text/css" rel="stylesheet" href="css/demo.css" />
		<link type="text/css" rel="stylesheet" href="http://fonts.googleapis.com/css?family=Anton" />
		<script type="text/javascript" src="js/modernizr/modernizr-2.5.3.min.js"></script>
    </head>
    <body>
		<header class="dark">
			<div class="container_16">
				<h1><a href="/">jump.js - jQuery Bing maps <span id="version"></span></a> filter by property</h1>
			</div>
		</header>
		<div class="container_16">
			<article class="grid_16">
				<div class="item rounded dark">
					<div id="map_canvas"></div>
					<div id="filter_control" class="item gradient rounded shadow" style="margin:5px;padding:5px 5px 5px 10px;"></div>
				</div>
				<div class="content rounded light shadow">
					<h2>Using jump.js with Bing maps</h2>
					<p>
						Download <a href="http://jquery.com/">jQuery 1.4.X or higher</a> or
						use <a href="http://code.google.com/intl/sv-SE/apis/libraries/devguide.html">Googles</a> or <a href="http://www.asp.net/ajaxlibrary/cdn.ashx">Microsofts</a> 
						<abbr title="Content delivery network"><a href="http://en.wikipedia.org/wiki/Content_delivery_network">CDN</a></abbr>.
					</p>
<pre class="prettyprint rounded">
&lt;script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="PATH_TO_PLUGIN/jump.js"&gt;&lt;/script&gt;</pre>

<pre class="prettyprint rounded">
$('#map_canvas').jump({'credentials': YOUR_BING_MAP_CREDENTIALS, 'center': '0.0, 0.0' }).bind('init', function () {
	$('#map_canvas').jump('addMarker', { 'foo': 'bar', 'location': '1.0, 1.0' });
	$('#map_canvas').jump('addMarker', { 'foo': 'baz', 'location': '2.0, 2.0' });
	$('#map_canvas').jump('find', 'markers', { 'property': 'foo', 'value': 'bar' }, function(marker, found) {
		marker.setOptions({'visible': found });
	});
});</pre>

<p>The find method is n-n, meaning it can find a multiple value within a array. If you need both values (bar and boz) to be included add the property 'operator':'AND'</p>
<pre class="prettyprint rounded">
$('#map_canvas').jump({'credentials': YOUR_BING_MAP_CREDENTIALS, 'center': '0.0, 0.0' }).bind('init', function () {
	$('#map_canvas').jump('addMarker', { 'foo': 'bar,baz,boz', 'location': '1.0, 1.0' });
	$('#map_canvas').jump('addMarker', { 'foo': 'baz', 'location': '2.0, 2.0' });
	$('#map_canvas').jump('find', 'markers', { 'property': 'foo', 'value': ['bar','boz'] }, function(marker, found) {
		marker.setOptions({'visible': found });
	});
});</pre>

<p>If you need to know whether or not a markers position is visible in viewport, use can use the inViewport method.</p>
<pre class="prettyprint rounded">
$('#map_canvas').jump('addMarker', { 'location': '0, 0' }, function(map, marker) {
	alert('Am I visible: ' + ( $('#map_canvas').jump('inViewport', marker) ) ? 'Yes' : 'No';
});</pre>

<pre class="prettyprint rounded">
$('#map_canvas').jump('addMarker', { 'id': 'some_id', 'location': '0, 0' });
$('#map_canvas').jump('inViewport', $('#map_canvas').gmap('get', 'marker > some_id'));</pre>

				</div>
			</article>
		</div>
		<footer class="dark">
			<div class="container_16">
				<div class="grid_8 more">
					<h2>More Bing maps and jump.js examples</h2>
					<ul>
						<li><a href="jump-bing-maps-hello-world-example.html">Bing maps with jQuery mobile "Hello world" example</a></li>
						<li class="sel buttonize"><a href="jump-bing-maps-filter-by-property.html">Filter pushpins by property</a></li>
						<li><a href="jump-bing-maps-load-marker-by-json.html">Load Bing map with JSON data</a></li>
						<li><a href="jump-bing-maps-geocoding-search.html">Address and longitude/latitude (Geocoding) lookup with Bing maps</a></li>
						<li><a href="jump-bing-maps-microdata.html">Add markers with microdata</a></li>
						<li><a href="jump-bing-maps-microformat.html">Add markers with microformats</a></li>
						<li><a href="jump-bing-maps-rdfa.html">Add markers with RDFa</a></li>
						<li><a href="jump-bing-maps-extend-with-pagination.html">Extend the plugin with pagination</a></li>
						<li><a href="jump-bing-maps-clustering.html">Using clusters with Bing Maps</a></li>
						<li><a href="jump-bing-maps-data-attribute.html">Add markers with jQuery data attribute</a></li>
						<li><a href="jump-bing-maps-geolocation.html">Bing maps with geolocation</a></li>
						<li><a href="jump-bing-maps-polygons-and-polylines.html">Polygons and polylines example</a></li>
						<li><a href="jump-bing-maps-mobile.html">Bing maps with jQuery mobile (jQM)</a></li>
					</ul>
				</div>
				<div id="forum" class="hidden rounded forum grid_8"></div>
				<div class="grid_16" itemscope itemtype="http://data-vocabulary.org/Person">
					Author: <span itemprop="name">Johan S&auml;ll Larsson</span> (<a href="http://johansalllarsson.se" itemprop="url">http://johansalllarsson.se</a>)
				</div>
			</div>
		</footer>
		<script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
		<script type="text/javascript" src="js/jquery/jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="js/underscore/underscore-1.3.3.min.js"></script>
		<script type="text/javascript" src="js/backbone/backbone-0.9.2.min.js"></script>
		<script type="text/javascript" src="js/prettify/prettify.min.js"></script>
		<script type="text/javascript" src="js/demo.js"></script>
		<script type="text/javascript" src="../src/bing-maps/jump.js"></script>
		<script type="text/javascript">
            $(function() { 
				demo.add(function() {
					$('#map_canvas').jump(demo.mapOptions, function() {
						var self = this;
						self.addControl('filter_control', 2);
						var map = self.get('map');
						var bounds = map.getBounds();
						var southWest = bounds.getSoutheast();
						var northEast = bounds.getNorthwest();
						var lngSpan = northEast.longitude - southWest.longitude;
						var latSpan = northEast.latitude - southWest.latitude;
						var images = [ 'http://google-maps-icons.googlecode.com/files/friends.png', 'http://google-maps-icons.googlecode.com/files/home.png', 'http://google-maps-icons.googlecode.com/files/girlfriend.png', 'http://google-maps-icons.googlecode.com/files/dates.png', 'http://google-maps-icons.googlecode.com/files/realestate.png', 'http://google-maps-icons.googlecode.com/files/apartment.png', 'http://google-maps-icons.googlecode.com/files/family.png' ];
						var tags = ['jQuery', 'Google maps', 'Plugin', 'SEO', 'Java', 'PHP', 'C#', 'Ruby', 'JavaScript', 'HTML'];
						$.each(tags, function(i, tag) {
							$('#filter_control').append(('<label style="margin-right:5px;display:block;"><input type="checkbox" style="margin-right:3px" value="{0}"/>{1}</label>').format(tag, tag));
						});
						for ( i = 0; i < 50; i++ ) {
							var temp = [];
							for ( j = 0; j < Math.random()*5; j++ ) {
								temp.push(tags[Math.floor(Math.random()*10)]);
							}
							self.addMarker({ 'icon': images[(Math.floor(Math.random()*7))], 'height': 37, 'width': 32, 'tags': temp, 'bounds':true, 'location': new Microsoft.Maps.Location(southWest.latitude + latSpan * Math.random(), southWest.longitude + lngSpan * Math.random()) }).click(function() {
								self.openInfoWindow({ 'title': this.target.tags.toString(), 'description': ( self.inViewport(this.target) ) ? 'I\'m visible in the viewport.' : 'The icon might show but I\'m sad and invisible.' }, this);
							});
						}
						$('input:checkbox').click(function() {
							$('#map_canvas').jump('closeInfoWindow');
							$('#map_canvas').jump('set', 'bounds', null);
							var filters = [];
							$('input:checkbox:checked').each(function(i, checkbox) {
								filters.push($(checkbox).val());
							});
							if ( filters.length > 0 ) {
								$('#map_canvas').jump('find', 'markers', { 'property': 'tags', 'value': filters, 'operator': 'AND' }, function(marker, found) {
									if (found) {
										$('#map_canvas').jump('addBounds', marker.getLocation());
									}
									marker.setOptions({ 'visible': found }); 
								});
							} else {
								$.each($('#map_canvas').jump('get', 'markers'), function(i, marker) {
									$('#map_canvas').jump('addBounds', marker.getLocation());
									marker.setOptions({ 'visible': true }); 
								});
							}
						});
					});
				}).load();
			});
        </script>
    
	</body>
</html>